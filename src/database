-- 1) Create database (only if not already there)
CREATE DATABASE IF NOT EXISTS rescuetable;
USE rescuetable;

-- 2) Drop old tables if they exist (safe reset)
DROP TABLE IF EXISTS Volunteer;
DROP TABLE IF EXISTS request;

-- 3) Create Volunteer table with ENUM skill dropdown
CREATE TABLE Volunteer (
    volunteer_id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    location VARCHAR(100),
    phone_no VARCHAR(15) UNIQUE,
    availability ENUM('Yes','No') DEFAULT 'Yes',
    skill ENUM('First Aid','Rescue Ops','Medical Support','Food Distribution','Shelter Management') NOT NULL,
    reward_points INT DEFAULT 0,
    attended_requests INT DEFAULT 0
);

-- 4) Create Request table with unique constraint
CREATE TABLE request (
    request_no INT AUTO_INCREMENT PRIMARY KEY,
    user_name VARCHAR(100) NOT NULL,
    location VARCHAR(100) NOT NULL,
    disaster_type ENUM('Flood','Earthquake','Fire','Landslide','Cyclone','Other') NOT NULL,
    rescue_needed_conditions TEXT,
    status ENUM('Pending','Ongoing','Completed') DEFAULT 'Pending',
    CONSTRAINT unique_request UNIQUE (user_name, location, disaster_type)
);

-- 5) Insert sample volunteers
INSERT INTO Volunteer (name, location, phone_no, availability, skill)
VALUES
('John Mathew', 'Kochi', '9876543210', 'Yes', 'First Aid'),
('Anita Joseph', 'Thrissur', '9123456780', 'Yes', 'Rescue Ops'),
('Rahul Nair', 'Kottayam', '9988776655', 'Yes', 'Medical Support');

-- 6) Insert sample requests
INSERT IGNORE INTO request (user_name, location, disaster_type, rescue_needed_conditions, status)
VALUES
('Binu Thomas', 'Aluva', 'Flood', 'Need food and water for 5 people', 'Pending'),
('Shalini Varghese', 'Idukki', 'Landslide', 'Medical help needed for injured persons', 'Ongoing');

-- 7) View data
SELECT * FROM Volunteer;
SELECT * FROM request;
